version: "3"

services:

  integration_tests:
    #image: ethereumoptimism/integration-tests:master
    image: ethereumoptimism/integration-tests:docker-entrypoint-new
    env_file:
      - ./docker-compose.env
    environment:
      - "PKGS=integration-tests"
      #- "PKGS=${PKGS}"

  l1_chain:
    image: ethereumoptimism/hardhat:master
    ports:
      - 9545:9545
    env_file:
      - ./docker-compose.env

  geth_l2:
    #image: ethereumoptimism/go-ethereum:master
    image: ethereumoptimism/go-ethereum:docker-entrypoint-new
    volumes:
      - geth:/l2-node/l2:rw
    env_file:
      - ./docker-compose.env
    ports:
      - 8545:8545
    entrypoint: ["/bin/wait-for-l1.sh", "geth", "--verbosity=6"]

  batch_submitter:
    image: ethereumoptimism/batch-submitter:master
    env_file:
      - ./docker-compose.env

  deployer:
    image: ethereumoptimism/deployer:master
    env_file:
      - ./docker-compose.env
    ports:
      - 8080:8080

volumes:
  geth:
